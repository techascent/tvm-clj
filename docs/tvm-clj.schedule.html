<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tvm-clj.schedule documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tvm-clj</span> <span class="project-version">6.00-beta-1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="background.html"><div class="inner"><span>Technical Background</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tvm-clj</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>application</span></div></div></li><li class="depth-3 branch"><a href="tvm-clj.application.image.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>image</span></div></a></li><li class="depth-3"><a href="tvm-clj.application.kmeans.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kmeans</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.ast.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>ast</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.compiler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compiler</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>device</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.module.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>module</span></div></a></li><li class="depth-2 current"><a href="tvm-clj.schedule.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schedule</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tvm-clj.schedule.html#var--.3Estage"><div class="inner"><span>-&gt;stage</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-create-schedule"><div class="inner"><span>create-schedule</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-schedule-cache-read"><div class="inner"><span>schedule-cache-read</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-schedule-cache-write"><div class="inner"><span>schedule-cache-write</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-bind"><div class="inner"><span>stage-bind</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-bind-gpu"><div class="inner"><span>stage-bind-gpu</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-compute-at"><div class="inner"><span>stage-compute-at</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-cpu-injective"><div class="inner"><span>stage-cpu-injective</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-fuse"><div class="inner"><span>stage-fuse</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-gpu-injective"><div class="inner"><span>stage-gpu-injective</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-inline"><div class="inner"><span>stage-inline</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-parallel"><div class="inner"><span>stage-parallel</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-reorder"><div class="inner"><span>stage-reorder</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-split-axis"><div class="inner"><span>stage-split-axis</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-tile"><div class="inner"><span>stage-tile</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-unroll"><div class="inner"><span>stage-unroll</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-stage-vectorize"><div class="inner"><span>stage-vectorize</span></div></a></li><li class="depth-1"><a href="tvm-clj.schedule.html#var-throw-nil"><div class="inner"><span>throw-nil</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tvm-clj.schedule</h1><div class="doc"><div class="markdown"><p>After describing the algorithm, the user creates a ‘schedule’ for the algorithm which involve transformations to the algorithm that are guaranteed not to change the results such as the tiling a computation across a tensor.</p></div></div><div class="public anchor" id="var--.3Estage"><h3>-&gt;stage</h3><div class="usage"><code>(-&gt;stage stage-or-schedule operation)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L29">view source</a></div></div><div class="public anchor" id="var-create-schedule"><h3>create-schedule</h3><div class="usage"><code>(create-schedule op-seq)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L20">view source</a></div></div><div class="public anchor" id="var-schedule-cache-read"><h3>schedule-cache-read</h3><div class="usage"><code>(schedule-cache-read schedule tensor cache-type readers)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L107">view source</a></div></div><div class="public anchor" id="var-schedule-cache-write"><h3>schedule-cache-write</h3><div class="usage"><code>(schedule-cache-write schedule tensor cache-type)</code></div><div class="doc"><div class="markdown"><p>Returns a new tensor</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L99">view source</a></div></div><div class="public anchor" id="var-stage-bind"><h3>stage-bind</h3><div class="usage"><code>(stage-bind stage iter-var thread-ivar)</code></div><div class="doc"><div class="markdown"><p>Bind an iter-var to a stage variable</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L47">view source</a></div></div><div class="public anchor" id="var-stage-bind-gpu"><h3>stage-bind-gpu</h3><div class="usage"><code>(stage-bind-gpu stage block-axis-seq thread-axis-seq)</code></div><div class="doc"><div class="markdown"><p>Bind the gpu-defined axis to the tvm axis. GPU (cuda, opencl) define a roughly level stage breakdown of axis: block and thread. Threads run on the same block and can share a special kind of memory (called shared memory). There can be up to 3 tvm axis per block or thread and these are labeled (outer iterator to inner iterator): [z y x]</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L112">view source</a></div></div><div class="public anchor" id="var-stage-compute-at"><h3>stage-compute-at</h3><div class="usage"><code>(stage-compute-at src-stage dst-stage dst-axis)</code></div><div class="doc"><div class="markdown"><p>Compute src stage at dst stage dst axis</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L53">view source</a></div></div><div class="public anchor" id="var-stage-cpu-injective"><h3>stage-cpu-injective</h3><div class="usage"><code>(stage-cpu-injective stage op &amp; {:keys [axis]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L156">view source</a></div></div><div class="public anchor" id="var-stage-fuse"><h3>stage-fuse</h3><div class="usage"><code>(stage-fuse stage axis-args)</code></div><div class="doc"><div class="markdown"><p>Fuse n-axis together, returns single new axis</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L59">view source</a></div></div><div class="public anchor" id="var-stage-gpu-injective"><h3>stage-gpu-injective</h3><div class="usage"><code>(stage-gpu-injective stage op &amp; {:keys [thread-count axis], :or {thread-count 16}})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L143">view source</a></div></div><div class="public anchor" id="var-stage-inline"><h3>stage-inline</h3><div class="usage"><code>(stage-inline stage)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L74">view source</a></div></div><div class="public anchor" id="var-stage-parallel"><h3>stage-parallel</h3><div class="usage"><code>(stage-parallel stage axis)</code></div><div class="doc"><div class="markdown"><p>Indicate that this axis has complete parallelism</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L68">view source</a></div></div><div class="public anchor" id="var-stage-reorder"><h3>stage-reorder</h3><div class="usage"><code>(stage-reorder stage axis-seq)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L84">view source</a></div></div><div class="public anchor" id="var-stage-split-axis"><h3>stage-split-axis</h3><div class="usage"><code>(stage-split-axis stage iter-var factor)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L42">view source</a></div></div><div class="public anchor" id="var-stage-tile"><h3>stage-tile</h3><div class="usage"><code>(stage-tile stage outer-axis inner-axis outer-dim inner-dim)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L79">view source</a></div></div><div class="public anchor" id="var-stage-unroll"><h3>stage-unroll</h3><div class="usage"><code>(stage-unroll stage axis)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L94">view source</a></div></div><div class="public anchor" id="var-stage-vectorize"><h3>stage-vectorize</h3><div class="usage"><code>(stage-vectorize stage axis)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L89">view source</a></div></div><div class="public anchor" id="var-throw-nil"><h3>throw-nil</h3><div class="usage"><code>(throw-nil item key-val)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/master/src/tvm_clj/schedule.clj#L11">view source</a></div></div></div></body></html>